--- 
layout: post
comments: true
title: !binary |
  5L+d6K+B5LiK5Lyg5paH5Lu25ZCN5a2X55qE5ZSv5LiA5oCn

date: 2007-5-20
link: false
categories: life
---
上传文件是都需要用到的功能，可以用以下代码实现：src_filename = params[:file][:name] if !src_filename.original_filename.empty?   hashed_name = Digest::SHA1.hexdigest(Time.now.to_s)   filename = &quot;#{RAILS_ROOT}/public/attachments/&quot; + hashed_name + &quot;_&quot; + src_filename.original_filename   if File.open(filename, 'w'){ |f| f.write(src_filename.read) }       attachment = Attachment.new      attachment.name = src_filename.original_filename      attachment.hashed_name = hashed_name      attachment.size = src_filename.size      comment.attachments &lt;&lt; attachment   end  end 当然，还有做一些后缀校验等。。。
